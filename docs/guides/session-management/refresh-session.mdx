---
id: refresh-session
title: Refresh and Extend Sessions
---

Use cases exist where sessions need to be refreshed on user activity or per
administrative intervention. When a session is refreshed, the session's
`expires` property is set to the current time plus the configured
`/session/lifespan` value.

## Extend Sessions as an Administrator

To extend a session's lifespan, call the administrative
[`adminRefreshSession`](../../reference/api.mdx#operation/adminRefreshSession)
endpoint with the session's ID, which you receive from `toSession` /
`/sessions/whoami`:

```mdx-code-block
import { getSdkUrl } from '@site/src/hooks'
import CodeBlock from '@theme/CodeBlock'

<CodeBlock>{`PATCH ${getSdkUrl().url}/admin/sessions/{id}/refresh
Authorization: Bearer {your-personal-access-token}`}</CodeBlock>
```

This document walks you through managing user session expiration time.

## Extend user session using the admin endpoints

````mdx-code-block
import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'

<Tabs
  defaultValue="curl"
  values={[
    {label: 'curl', value: 'curl'},
  ]}>
<TabItem value="curl">

```shell script
$ curl 'https://{your-project-slug}.projects.oryapis.com/admin/sessions/ede90ce6-2420-435a-a745-3d8ab1a9636c/extend' \
    -H 'Accept: application/json' | jq

{
  "id": "ede90ce6-2420-435a-a745-3d8ab1a9636c",
  "active": true,
  "expires_at": "2020-09-04T21:32:47.5642404Z",
  "authenticated_at": "2020-09-03T21:32:47.5881038Z",
  "issued_at": "2020-09-03T21:32:47.5642688Z",
  "identity": {
    "id": "d96e86d9-bc33-4aa5-b865-4ade8a3974b3",
    "schema_id": "default",
    "schema_url": "http://127.0.0.1:4433/schemas/default",
    "traits": {
      "email": "foouser@ory.sh",
      "name": {
        "first": "foo",
        "last": "user"
      }
    },
    "verifiable_addresses": [
      {
        "id": "81bbdeae-6333-42f2-877e-26c78acb6ea5",
        "value": "foouser@ory.sh",
        "verified": false,
        "via": "email",
        "status": "pending",
        "verified_at": null
      }
    ],
    "recovery_addresses": [
      {
        "id": "596c1db4-ccaa-4f4e-9623-cb7e768026ad",
        "value": "foouser@ory.sh",
        "via": "email"
      }
    ]
  }
}
```

</TabItem>
</Tabs>
````

## Reduce Database Load

Since session refresh causes database writes it's possible to set a config value
to allow session refresh for a specific time before the session expires. If we
set the `earliest_refresh` equal to `lifespan`, it's possible to refresh even
new sessions.

Sets when a session can be extended. Settings this value to `24h` will prevent
the session from being extended before until 24 hours before it expires. This
setting prevents excessive writes to the database and we highly recommend
setting this value!

:::warning

Setting `earliest_refresh` to `lifespan`, all sessions will constantly be
refreshed!

:::

````mdx-code-block
<Tabs>
  <TabItem value="cloud" label="Ory CLI" default>

```shell
ory patch identity-config <your-project-id> \\
  --replace '/session/earliest_possible_extend="24h"'
```

  </TabItem>
  <TabItem value="macos" label="Self-Hosted Ory Kratos Config" default>

```shell title=path/to/kratos/config.yml
ory patch kratos-config <your-project-id> \\
  --replace '/session/earliest_possible_extend="24h"' \\
  --format yaml
```

  </TabItem>
</Tabs>
````
