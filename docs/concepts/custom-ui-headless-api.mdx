---
id: custom-ui-headless-api
title: Introduction to Self-service APIs
sidebar_label: Introduction to self-Service APIs
toc_max_heading_level: 4
---

```mdx-code-block
import Tabs from "@theme/Tabs"
import TabItem from "@theme/TabItem"
import CodeBlock from "@theme/CodeBlock"
```

Ory provides headless APIs for ease of integration. This ensures that Ory provides compatibility with many software stacks across
different programming languages.

This documents' focus is to provide concrete examples on custom UI integration. Flows are the fundamental of Ory's self-service
APIs and are used to accomplish a variety of goals, such as `login`, `registration`, `settings`, `verification` and `recovery`.

The self-service `flows` are standardised so that it follows the same steps regardless of which `flow` is integrated.

A general overview of the flow can be summed up in two steps:

1. Get or create the `flow` data, e.g. login, registration etc.
2. Submit the `flow` with user data (e.g. username and password)

For more information on the concepts take a look at the [Self-service flow](../kratos/self-service) documentation.

:::note

Depending on the type of application (browser or native) the initialized flow will set a CSRF cookie and return a CSRF token in
the response body. It is important in **browser based applications** to take note of the CSRF tokens since it is required when
submitting the user data.

:::

## Login flow

Login flows are used to authenticate users. When the login is successful the request will respond with a `200 OK` HTTP status code
and a JSON body containing the user's identity information. When the request fails, it responds with the appropriate HTTP status
and error messages.

### Create Login flow

The flow always has to be initialized before any user data (e.g. username and password) can be submitted. Depending on the type of
application (e.g. browser or native) the initialized flow will set a CSRF cookie and return a CSRF token in the response body. It
is important to take note of the CSRF tokens since it is required when submitting the user data.

````mdx-code-block
<Tabs groupId="sdk-examples">

<TabItem value="go" label="Go" default>

```mdx-code-block
import createLoginApi from '!!raw-loader!../../code-examples/sdk/go/selfservice/create-login.go'

<CodeBlock language="go">{createLoginApi}</CodeBlock>
```

</TabItem>
<TabItem value="typescript" label="TypeScript">
    TypeScript example
</TabItem>

</Tabs>
````

### Get Login flow

In cases where the flow already exists we can retrieve the flow data using the flow ID. This is useful in cases where Ory has
already initialized the flow and redirected to the UI. In such a case the flow ID can be extracted from the URL `?flow=` query
parameter.

Here are some cases where the flow would already exist:

1. Ory has initialized the flow and redirects to the UI (e.g. `/login?flow=<uuidv4>`)
2. The request was completed by the user, however, an error occurred and we need to retrieve the flow data to display the error
3. The UI has 'stored' the flow ID in the URL so that page refreshes can retrieve the flow data

:::note

The flow ID has an expiration time, so it is important to check the response status code when retrieving the flow data using an
existing flow ID. It is up to your application to handle this and create a new flow if the flow ID has expired.

:::

````mdx-code-block
<Tabs groupId="sdk-examples">

<TabItem value="go" label="Go" default>

```mdx-code-block
import getLoginApi from '!!raw-loader!../../code-examples/sdk/go/selfservice/get-login.go'

<CodeBlock language="go">{getLoginApi}</CodeBlock>
```

</TabItem>

<TabItem value="typescript" label="TypeScript">
TypeScript example
</TabItem>

</Tabs>
````

### Submit Login flow

We can submit the login flow with user data (e.g. username and password) using the flow ID. Depending on the type of application
(e.g. browser or native) the CSRF tokens are required in the request body and cookie.

:::note

In some cases the response code could be `422` which indicates that the browser needs to be redirected with a new flow. In Single
Page Applications (SPAs) the response can be decoded and the new flowID extracted.

:::

````mdx-code-block
<Tabs groupId="sdk-examples">

<TabItem value="go" label="Go" default>

```mdx-code-block
import submitLoginApi from '!!raw-loader!../../code-examples/sdk/go/selfservice/submit-login.go'

<CodeBlock language="go">{submitLoginApi}</CodeBlock>
```

</TabItem>

<TabItem value="typescript" label="TypeScript">
TypeScript example
</TabItem>

</Tabs>
````

:::note

A session cookie or token can also be prevented on login using additional checks, such as only allowing verified users to login.
For more information, please take a look at
[Customize login and registration](../identities/sign-in/actions#allow-login-only-with-verified-email)

:::

### More Concepts and API References

More conceptual information on the login flow can be found in [Self-service Login Flow](../kratos/self-service/flows/user-login).

For API references, please take a look at the [API Reference](../reference/api) section.

Below are the API references for the login flow.

- [Get Browser Login Flow](../reference/api#tag/frontend/operation/getLoginFlow)
- [Get Native Login Flow](../reference/api#tag/frontend/operation/getLoginFlow)
- [Create Login Flow](../reference/api#tag/frontend/operation/createBrowserLoginFlow)
- [Update Login Flow](../reference/api#tag/frontend/operation/updateLoginFlow)

## Registration flow

Registration flows are used to register users. When the registration is successful the request will respond with a `200 OK` HTTP
status code. When the request fails, it responds with the appropriate HTTP status and error messages.

:::note

Registration data is dependent on the [Identity Schema](../identities/manage-identity-schema) traits. This ensures registration
flows are flexible and can be used for a variety of use cases.

:::

### Create Registration flow

The flow always has to be initialized before any user data (e.g. username and password) can be submitted. Depending on the type of
application (e.g. browser or native) the initialized flow will set a CSRF cookie and return a CSRF token in the response body. It
is important to take note of the CSRF tokens since it is required when submitting the user data.

````mdx-code-block
<Tabs groupId="sdk-examples">

<TabItem value="go" label="Go" default>

```mdx-code-block
import createRegistrationApi from '!!raw-loader!../../code-examples/sdk/go/selfservice/create-registration.go'

<CodeBlock language="go">{createRegistrationApi}</CodeBlock>
```

</TabItem>

<TabItem value="typescript" label="TypeScript">
TypeScript example
</TabItem>

</Tabs>
````

### Get Registration flow

````mdx-code-block
<Tabs groupId="sdk-examples">

<TabItem value="go" label="Go" default>

```mdx-code-block
import getRegistrationApi from '!!raw-loader!../../code-examples/sdk/go/selfservice/get-registration.go'

<CodeBlock language="go">{getRegistrationApi}</CodeBlock>
```

</TabItem>

<TabItem value="typescript" label="TypeScript">
TypeScript example
</TabItem>

</Tabs>
````

### Submit Registration flow

````mdx-code-block
<Tabs groupId="sdk-examples">

<TabItem value="go" label="Go" default>

```mdx-code-block
import submitRegistrationApi from '!!raw-loader!../../code-examples/sdk/go/selfservice/submit-registration.go'

<CodeBlock language="go">{submitRegistrationApi}</CodeBlock>
```

</TabItem>

<TabItem value="typescript" label="TypeScript">
TypeScript example
</TabItem>

</Tabs>
````

:::note

A session cookie or token is only available after registration when enabled in the Ory configuration. More information can be
found in [Customize login and registration](../identities/sign-in/actions#log-in-users-after-registration).

:::

## Recovery

Recovery flows are used to recover user credentials. The recovery flow has two methods, `link` and `code` which determines how the
how the recovery flow is completed. The `link` method sends a recovery link and `code` sends a recovery code to the user's email
address.

:::note

The `code` method is preferred to the `link` method to prevent the recovery from being invalidated by email clients and spam
filters.

:::

### Create Recovery flow

````mdx-code-block
<Tabs groupId="sdk-examples">

<TabItem value="go" label="Go" default>

```mdx-code-block
import createRecoveryApi from '!!raw-loader!../../code-examples/sdk/go/selfservice/create-recovery.go'

<CodeBlock language="go">{createRecoveryApi}</CodeBlock>
```

</TabItem>

<TabItem value="typescript" label="TypeScript">
TypeScript example
</TabItem>

</Tabs>
````

### Get Recovery flow

````mdx-code-block
<Tabs groupId="sdk-examples">

<TabItem value="go" label="Go" default>

```mdx-code-block
import getRecoveryApi from '!!raw-loader!../../code-examples/sdk/go/selfservice/get-recovery.go'

<CodeBlock language="go">{getRecoveryApi}</CodeBlock>
```

</TabItem>

<TabItem value="typescript" label="TypeScript">
TypeScript example
</TabItem>

</Tabs>
````

### Submit Recovery flow

````mdx-code-block
<Tabs groupId="sdk-examples">

<TabItem value="go" label="Go" default>

```mdx-code-block
import submitRecoveryApi from '!!raw-loader!../../code-examples/sdk/go/selfservice/submit-recovery.go'

<CodeBlock language="go">{submitRecoveryApi}</CodeBlock>
```

</TabItem>

<TabItem value="typescript" label="TypeScript">
TypeScript example
</TabItem>

</Tabs>
````

### More Concepts and API References

More information on the registration flow can be found in
[Self-service Registration Flow](../kratos/self-service/user-registration)

Below are the API references for the registration flow.

Browser flows:

[Create Registration Flow](../reference/api#tag/frontend/operation/createBrowserRegistrationFlow)
[Get Registration Flow](../reference/api#tag/frontend/operation/getRegistrationFlow)
[Update Registration Flow](../reference/api#tag/frontend/operation/updateRegistrationFlow)

Native flows:

[Create Registration Flow](../reference/api#tag/frontend/operation/createNativeRegistrationFlow)
[Get Registration Flow](../reference/api#tag/frontend/operation/getRegistrationFlow)
[Update Registration Flow](../reference/api#tag/frontend/operation/updateRegistrationFlow)
